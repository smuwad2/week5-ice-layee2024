<!DOCTYPE html>
<html>
    <head>

        <!-- Bootstrap -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        
         <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    </head>
    <body>
        <div class="bg-light text-center p-5 mb-4">
            <h2>Choose an option:</h2>
            <label for="limit">Limit:</label>
            <input onchange="getData()" id="limit" type="number" min=1 max=5 value=1>
            <select onchange="getData()" id="type">
                <option value="customers">Customers</option>
                <option value="products">Products</option>
                <option value="suppliers">Suppliers</option>
            </select>
            
        </div>
        <div id="result">

        </div>
        <script>
  function buildTable(records, type) {
    if (!records || records.length === 0) {
      return `<h2>${type}</h2><p>No data</p>`;
    }

    const headers = Object.keys(records[0]);

    let s = `
      <h2>${type}</h2>
      <table class="table">
        <thead>
          <tr>${headers.map(h => `<th>${h}</th>`).join('')}</tr>
        </thead>
        <tbody>
    `;

    for (const row of records) {
      s += `<tr>${headers.map(h => `<td>${row[h]}</td>`).join('')}</tr>`;
    }

    s += `
        </tbody>
      </table>
    `;
    return s;
  }

  async function getData() {
    const limit = document.getElementById('limit').value;
    const type  = document.getElementById('type').value;
    try {
      const res = await axios.get('/data', { params: { type, limit } });
      const { records } = res.data;
      document.getElementById('result').innerHTML = buildTable(records, type);
    } catch (err) {
      console.error(err);
      document.getElementById('result').innerHTML = `<h2>${type}</h2><p class="text-danger">Failed to load data</p>`;
    }
  }

  window.addEventListener('DOMContentLoaded', getData);
</script>


</body>
</html>